<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Scientia Potestas Est</title>
  <meta name="theme-color" content="#222222" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="http://www.ashwinnarayan.com/blog/js/jquery.min.js"></script>
  <script src="http://www.ashwinnarayan.com/blog/js/bootstrap.min.js"></script>
  <script src="http://www.ashwinnarayan.com/blog/js/header.js"></script>
  <script src="http://www.ashwinnarayan.com/blog/js/toc.js"></script>
  <link href="http://www.ashwinnarayan.com/blog/css/bootstrap.min.css" rel="stylesheet">
  <link href="http://www.ashwinnarayan.com/blog/css/theme.css" rel="stylesheet">
  <link href="http://www.ashwinnarayan.com/blog/css/syntax.css" rel="stylesheet">
  <link href="http://www.ashwinnarayan.com/blog/css/font-awesome/css/font-awesome.min.css" rel="stylesheet">
</head>

<body>

  

  


 <script type="text/javascript">
  WebFontConfig = {
    google: {
      families: ['Ubuntu::latin']
    }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();
</script>

  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.ashwinnarayan.com/blog/">Scientia Potestas Est</a>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
          <li><a href="http://www.ashwinnarayan.com/blog/">/home</a></li>
          <li><a href="http://www.ashwinnarayan.com/blog/archive.html">/archive</a></li>
          <li><a href="http://www.ashwinnarayan.com/blog/tags.html">/tags</a></li>
          <li><a href="http://www.ashwinnarayan.com/blog/about.html">/about</a></li>
        </ul>
      </div>
    </div>
  </nav>


<div class="wrapper">
  <div class="content">
    <div class="container container-center">
      <div class="row">
        <div class="col-md-8">
          <div class="article">
            <div class="well">
              <h1><a href="http://www.ashwinnarayan.com/blog/2016/03/unsupervised-learning-self-organizing">Unsupervised Learning: Self Organizing Maps</a></h1>
              <div class="post-meta">
                <div class="post-time">
                  <!--<i class="fa fa-calendar"></i>-->
		  Posted on:
                  <time>30 Mar 2016</time>
                </div>
                <ul>
		  <li>Tags: </li>
                  
                    <li><a href="http://www.ashwinnarayan.com/blog/tag/machine learning">machine learning</a></li>
                  
                    <li><a href="http://www.ashwinnarayan.com/blog/tag/python">python</a></li>
                  
                    <li><a href="http://www.ashwinnarayan.com/blog/tag/technical">technical</a></li>
                  
                </ul>
              </div>
              <div class="post-content">
                <div id="toc" class="toc"></div>
                <div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;">Most machine learning techniques like logistic regression, linear regression, and neural networks do something that is called supervised learning. This means that we need to supply examples of "correct" data to the machine learning algorithm for it to learn the patterns in the data. The goal of unsupervised learning is to automatically find clusters of similar data in a huge unlabeled set of data. Humans can do this easily with some types of data. If you saw a 2D scatter plot of points you'd easily be able to identify clusters in the data by visual examination. I've always considered unsupervised learning cooler than supervised mostly because it feels like that's what a general AI should be able to do.&nbsp;</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Self organizing maps (SOMs) are one technique used to find these clusters in the data. A self organizing map looks a little similar to a neural network at first. But the kind of operation that it does is very different. An SOM has a lattice of nodes. This lattice is usually one dimensional(arranged in a linear array) or 2 dimensional (arranged in a matrix). As the self organizing map is trained, the lattice of will be partitioned into separate classes. Since one of the main uses of self organizing maps is visualizing higher dimensional data, the lattice is is rarely more than two dimensions wide. The clusters in the higher dimensional data can be visualized on the 2D lattice. &nbsp;Associated with each of the nodes in the lattice is a weight vector that has the same dimension as the input data vectors. To train the self organizing map we take each element in the data set and find the node with the weight that's closest to the element (Using the euclidean distance as the measure of closeness. Other measures can be used too.). Then we define a neighbourhood of nodes that are 'close' to this best matching unit and we adjust the weights of this entire neighbourhood of weights to be a little closer to the value of the element from the dataset. How much the weights are adjusted depends on the neighbour falloff function and on the learning rate. This can be expressed in one simple equation.<br />$$W_{uv}(t+1) = W_{uv}(t)&nbsp;+ \Omega (u,v,t) \alpha (t)[x_n - W_{uv}(t)]&nbsp;$$<br />In each iteration, the learning rate and the size of the neighbourhood function is reduced by a small amount. The neighbourhood size is initially set to a large value. This allows the algorithm to initially affect the weights on a global scale and then over time adjust smaller and smaller regions of the map to train it.<br /><br /><script src="https://gist.github.com/RationalAsh/8c2c6cf4fde3834550a91da2ab95394b.js"></script><br /><br />In my implementation I used a Gaussian neighbourhood function whose variance decayed exponentially. The learning rate started off at 0.1 and decayed exponentially from there.<br /><br />To check my implementation, I tested something that is a common use for SOMs. Clustering colors in an RGB color space. Colors are easy to visualize and I thought it would make a good demo. I first generated a random data set of bluish, reddish, greenish and dark bluish colors.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://3.bp.blogspot.com/--qTzM7ansnA/VvtX29YCZCI/AAAAAAAAJQ8/loHqT6d-RF0WhE2bK7bkgzzrrX7jRqdOw/s1600/som_colors.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="492" src="https://3.bp.blogspot.com/--qTzM7ansnA/VvtX29YCZCI/AAAAAAAAJQ8/loHqT6d-RF0WhE2bK7bkgzzrrX7jRqdOw/s640/som_colors.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">A random sampling of 4 different colors for the dataset.</td></tr></tbody></table>I initialized the weights randomly and started the training. For this particular experiment I used a 2D 50x50 lattice of nodes. Since each node has a weight that is a 3 dimensional vector that represents a color, we can visualize the SOM node lattice as an RGB image. Stacking together the weight visualization after each epoch (One pass through the training set) of training gave me this really beautiful looking animation! :D<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://i.imgur.com/abO2QQe.gif" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://i.imgur.com/abO2QQe.gif" height="640" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Animation that shows the self organizing map after each epoch of training.</td></tr></tbody></table>&nbsp;You can clearly see the different clusters of color slowly resolving as the training happens. The initial changes are more global due to the large neighbourhood. But as the training progresses the adjustments to the weights become more and more local. There is also a very nice separation of the different colors that were present in the first image. You can see that the brighter colors seem to be congregating towards the top of the image and the darker colors towards the bottom. The darkest blue (maybe even a little black) ended up in the bottom left corner surrounded by the darker hues of red, green and blue.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://3.bp.blogspot.com/-YZi_65gGP8c/Vvtq5aBCXvI/AAAAAAAAJRM/7ZgSUZ8JFSwOx9WHaoOzXHVFaQ7uw55qQ/s1600/figure_30.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="https://3.bp.blogspot.com/-YZi_65gGP8c/Vvtq5aBCXvI/AAAAAAAAJRM/7ZgSUZ8JFSwOx9WHaoOzXHVFaQ7uw55qQ/s640/figure_30.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">The final map after 30 epochs of training.</td></tr></tbody></table><br /><br /><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div></div>

                

              </div>
              
            </div>
          </div>
        </div>
        <div class="col-md-4 hidden-xs">
          <div class="sidebar ">
  <h2>Recent Posts</h2>
  <ul>
    
    <li><a href="/blog/2016/05/share-buttons">Share buttons</a></li>
    
    <li><a href="/blog/2016/03/unsupervised-learning-self-organizing">Unsupervised Learning: Self Organizing Maps</a></li>
    
    <li><a href="/blog/2016/03/machine-learning-part-2-implementing">Machine Learning Part 2: Implementing Multi Class Logistic Regression</a></li>
    
    <li><a href="/blog/2016/02/my-first-build-of-bb-8">My First Build of BB-8</a></li>
    
    <li><a href="/blog/2015/12/jekyll-clean-theme">Jekyll Dark Clean Theme</a></li>
    
  </ul>
</div>

<div class="sidebar">
  <h2>Tags</h2>
  <ul>
    
      <li><a href="/blog/tag/jekyll">jekyll</a></li>
    
      <li><a href="/blog/tag/analytics">analytics</a></li>
    
      <li><a href="/blog/tag/tags">tags</a></li>
    
      <li><a href="/blog/tag/comments">comments</a></li>
    
      <li><a href="/blog/tag/code">code</a></li>
    
      <li><a href="/blog/tag/images">images</a></li>
    
      <li><a href="/blog/tag/robotics">robotics</a></li>
    
      <li><a href="/blog/tag/Mathematica">Mathematica</a></li>
    
      <li><a href="/blog/tag/technical">technical</a></li>
    
      <li><a href="/blog/tag/math">math</a></li>
    
      <li><a href="/blog/tag/machine learning">machine learning</a></li>
    
      <li><a href="/blog/tag/python">python</a></li>
    
      <li><a href="/blog/tag/fun">fun</a></li>
    
      <li><a href="/blog/tag/cool stuff">cool stuff</a></li>
    
      <li><a href="/blog/tag/star wars">star wars</a></li>
    
  </ul>
</div>

        </div>
      </div>
    </div>
    

  </div>
      <footer class="footer-distributed">
      <div class="container">
        <div class="footer">
          <p>Ashwin Narayan &copy; 2016</p>
          <h6>Follow me</h6>

<ul class="social-media">

  
    <li>
      <a title="RationalAsh on Github" href="https://github.com/RationalAsh" target="_blank"><i class="fa fa-github fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title=" on StackOverflow" href="http://stackoverflow.com/users/" target="_blank"><i class="fa fa-stack-overflow fa-2x"></i></a>
    </li>
  

  

  
    <li>
      <a title=" on Instagram" href="https://instagram.com/" target="_blank"><i class="fa fa-instagram fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title=" on Last.fm" href="http://lastfm.com/user/" target="_blank"><i class="fa fa-lastfm fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title="feed.xml RSS" href="/blog/feed.xml" target="_blank"><i class="fa fa-rss fa-2x"></i></a>
    </li>
  

</ul>

	  <p><a href="https://github.com/streetturtle/jekyll-clean-dark">Jekyll Clean Dark Theme</a> by Pavel Makhov</p>
        </div>
      </div>
    </footer>
  </body>
</html>

</div>
