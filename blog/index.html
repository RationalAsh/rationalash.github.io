<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Scientia Potestas Est</title>
  <meta name="theme-color" content="#222222" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="http://www.ashwinnarayan.com/blog/js/jquery.min.js"></script>
  <script src="http://www.ashwinnarayan.com/blog/js/bootstrap.min.js"></script>
  <script src="http://www.ashwinnarayan.com/blog/js/header.js"></script>
  <script src="http://www.ashwinnarayan.com/blog/js/toc.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    },
    jax: ["input/TeX","output/SVG"],
    CommonHTML: { linebreaks: { automatic: true } },
    "HTML-CSS": { linebreaks: { automatic: true } },
    SVG: { linebreaks: { automatic: true } }
  });
  </script>
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
  <link href="http://www.ashwinnarayan.com/blog/css/bootstrap.min.css" rel="stylesheet">
  <link href="http://www.ashwinnarayan.com/blog/css/theme.css" rel="stylesheet">
  <link href="http://www.ashwinnarayan.com/blog/css/syntax.css" rel="stylesheet">
  <link href="http://www.ashwinnarayan.com/blog/css/font-awesome/css/font-awesome.min.css" rel="stylesheet">
</head>

<body>

  

  


 <script type="text/javascript">
  WebFontConfig = {
    google: {
      families: ['Ubuntu::latin']
    }
  };
  (function() {
    var wf = document.createElement('script');
    wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
      '://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
    wf.type = 'text/javascript';
    wf.async = 'true';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(wf, s);
  })();
</script>

  <nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="http://www.ashwinnarayan.com/blog/">Scientia Potestas Est</a>
      </div>
      <div class="collapse navbar-collapse">
        <ul class="nav navbar-nav">
	  <li><a href="/blog">Ashwin</a></li>
          <li><a href="http://www.ashwinnarayan.com/blog/">/blog</a></li>
          <li><a href="http://www.ashwinnarayan.com/blog/archive.html">/archive</a></li>
          <li><a href="http://www.ashwinnarayan.com/blog/tags.html">/tags</a></li>
          <!--<li><a href="http://www.ashwinnarayan.com/blog/about.html">/about</a></li>-->
        </ul>
      </div>
    </div>
  </nav>

<div class="wrapper">
  <div class="content">
    <div class="container container-center">
      <div class="row">
        <div class="col-md-8">
          <div class="well">
            
  <h2 class="post-title">
    <a href="http://www.ashwinnarayan.com/blog/2016/06/new-website-and-blog">
      New Website and Blog
    </a>
  </h3>

  <div class="post-meta">
  <div class="post-time">
    <!--<i class="fa fa-calendar"></i>-->
    Posted on:
    <time>15 Jun 2016</time>
  </div>
  <ul>
    <li>Tags:</li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/programming">programming</a></li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/thoughts">thoughts</a></li>
    
  </ul>
</div>

  <div class="post-descr text-justify">
    <p>
      <p>As I mentioned in an <a href="http://www.ashwinnarayan.com/blog/2015/06/i-have-new-website">earlier post</a> (exactly a year ago! :D) I have my own website now. When I first bought the domain name and hosting package I opted to get a shared hosting server where I could build my own website using Wordpress. However, it never really satisfied me. I got a decent looking website up and running, but I had to work with the constraints of the Wordpress CMS. Whenever I wanted a part of my website to look a particular way, I had to go deep into menus and settings pages to try and tweak it to my liking. Also, most of the themes that were available didn’t meet all of my requirements. Some of them would almost meet them but would be missing one critical feature or the other. In the end, I had to compromise by picking a theme that was good enough. I let my website be for about a year as I didn’t have time in the middle of the semester to tweak everything to my liking.</p>

<p>In May I finally finished my bachelor’s degree. That left me with more time on my hands to tweak my website to my liking. I tried to keep the wordpress blog but I found working with Wordpress themes quite difficult if I wanted to modify them. In the end, I decided to go for something simple that worked: <a href="https://getbootstrap.com/">Bootstrap</a>. It was a barebones solution that produced good results using simple HTML classes. I found myself a good theme from <a href="http://startbootstrap.com/">Startbootstrap</a> and got started redesigning my website.</p>

<p>Since I was using a static site generator, I no longer needed a hosting service which allowed disk access. So I decided that <a href="https://pages.github.com">Github Pages</a> would be the new home of my website. I canceled the hosting service but kept my domain name and pointed it to my brand new github pages site.</p>

<p>I also discovered that it was possible to use <a href="https://jekyllrb.com">Jekyll</a> to produce static blogs that did not require databases. They also had support for importing blogger posts. Jekyll has a lot of cool in built markdown formatting features that Blogger lacks. So I decided to give it a shot. Although I got most of my important posts imported and running on a new Jekyll blog, I was a bit reluctant to leave the platform that I’d been using for so many years. In the end I decided to maintain both blogs separately. This Jekyll blog will mirror my old blog for the most part. However, this blog will be curated a little bit more strictly to contain only “professional” posts. My old blog will continue to be my outlet for both professional/technical and fun random posts.</p>

<p><img src="http://www.ashwinnarayan.com/blog/images/website_scrot.png" alt="website_screenshot" class="center-image" /><em>New Website</em></p>

<p><img src="http://www.ashwinnarayan.com/blog/images/blog_scrot.png" alt="blog_screenshot" class="center-image" /><em>New Blog</em></p>

    </p>
  </div>
  <hr>
  
  <h2 class="post-title">
    <a href="http://www.ashwinnarayan.com/blog/2016/03/unsupervised-learning-self-organizing">
      Unsupervised Learning: Self Organizing Maps
    </a>
  </h3>

  <div class="post-meta">
  <div class="post-time">
    <!--<i class="fa fa-calendar"></i>-->
    Posted on:
    <time>30 Mar 2016</time>
  </div>
  <ul>
    <li>Tags:</li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/machine learning">machine learning</a></li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/python">python</a></li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/technical">technical</a></li>
    
  </ul>
</div>

  <div class="post-descr text-justify">
    <p>
      <div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;">Most machine learning techniques like logistic regression, linear regression, and neural networks do something that is called supervised learning. This means that we need to supply examples of "correct" data to the machine learning algorithm for it to learn the patterns in the data. The goal of unsupervised learning is to automatically find clusters of similar data in a huge unlabeled set of data. Humans can do this easily with some types of data. If you saw a 2D scatter plot of points you'd easily be able to identify clusters in the data by visual examination. I've always considered unsupervised learning cooler than supervised mostly because it feels like that's what a general AI should be able to do.&nbsp;</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Self organizing maps (SOMs) are one technique used to find these clusters in the data. A self organizing map looks a little similar to a neural network at first. But the kind of operation that it does is very different. An SOM has a lattice of nodes. This lattice is usually one dimensional(arranged in a linear array) or 2 dimensional (arranged in a matrix). As the self organizing map is trained, the lattice of will be partitioned into separate classes. Since one of the main uses of self organizing maps is visualizing higher dimensional data, the lattice is is rarely more than two dimensions wide. The clusters in the higher dimensional data can be visualized on the 2D lattice. &nbsp;Associated with each of the nodes in the lattice is a weight vector that has the same dimension as the input data vectors. To train the self organizing map we take each element in the data set and find the node with the weight that's closest to the element (Using the euclidean distance as the measure of closeness. Other measures can be used too.). Then we define a neighbourhood of nodes that are 'close' to this best matching unit and we adjust the weights of this entire neighbourhood of weights to be a little closer to the value of the element from the dataset. How much the weights are adjusted depends on the neighbour falloff function and on the learning rate. This can be expressed in one simple equation.<br />$$W_{uv}(t+1) = W_{uv}(t)&nbsp;+ \Omega (u,v,t) \alpha (t)[x_n - W_{uv}(t)]&nbsp;$$<br />In each iteration, the learning rate and the size of the neighbourhood function is reduced by a small amount. The neighbourhood size is initially set to a large value. This allows the algorithm to initially affect the weights on a global scale and then over time adjust smaller and smaller regions of the map to train it.<br /><br /><script src="https://gist.github.com/RationalAsh/8c2c6cf4fde3834550a91da2ab95394b.js"></script><br /><br />In my implementation I used a Gaussian neighbourhood function whose variance decayed exponentially. The learning rate started off at 0.1 and decayed exponentially from there.<br /><br />To check my implementation, I tested something that is a common use for SOMs. Clustering colors in an RGB color space. Colors are easy to visualize and I thought it would make a good demo. I first generated a random data set of bluish, reddish, greenish and dark bluish colors.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://3.bp.blogspot.com/--qTzM7ansnA/VvtX29YCZCI/AAAAAAAAJQ8/loHqT6d-RF0WhE2bK7bkgzzrrX7jRqdOw/s1600/som_colors.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="492" src="https://3.bp.blogspot.com/--qTzM7ansnA/VvtX29YCZCI/AAAAAAAAJQ8/loHqT6d-RF0WhE2bK7bkgzzrrX7jRqdOw/s640/som_colors.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">A random sampling of 4 different colors for the dataset.</td></tr></tbody></table>I initialized the weights randomly and started the training. For this particular experiment I used a 2D 50x50 lattice of nodes. Since each node has a weight that is a 3 dimensional vector that represents a color, we can visualize the SOM node lattice as an RGB image. Stacking together the weight visualization after each epoch (One pass through the training set) of training gave me this really beautiful looking animation! :D<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://i.imgur.com/abO2QQe.gif" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" src="http://i.imgur.com/abO2QQe.gif" height="640" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Animation that shows the self organizing map after each epoch of training.</td></tr></tbody></table>&nbsp;You can clearly see the different clusters of color slowly resolving as the training happens. The initial changes are more global due to the large neighbourhood. But as the training progresses the adjustments to the weights become more and more local. There is also a very nice separation of the different colors that were present in the first image. You can see that the brighter colors seem to be congregating towards the top of the image and the darker colors towards the bottom. The darkest blue (maybe even a little black) ended up in the bottom left corner surrounded by the darker hues of red, green and blue.<br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://3.bp.blogspot.com/-YZi_65gGP8c/Vvtq5aBCXvI/AAAAAAAAJRM/7ZgSUZ8JFSwOx9WHaoOzXHVFaQ7uw55qQ/s1600/figure_30.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="640" src="https://3.bp.blogspot.com/-YZi_65gGP8c/Vvtq5aBCXvI/AAAAAAAAJRM/7ZgSUZ8JFSwOx9WHaoOzXHVFaQ7uw55qQ/s640/figure_30.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">The final map after 30 epochs of training.</td></tr></tbody></table><br /><br /><br /></div><div style="text-align: justify;"><br /></div><div style="text-align: justify;"><br /></div></div>

    </p>
  </div>
  <hr>
  
  <h2 class="post-title">
    <a href="http://www.ashwinnarayan.com/blog/2016/03/machine-learning-part-2-implementing">
      Machine Learning Part 2: Implementing Multi Class Logistic Regression
    </a>
  </h3>

  <div class="post-meta">
  <div class="post-time">
    <!--<i class="fa fa-calendar"></i>-->
    Posted on:
    <time>22 Mar 2016</time>
  </div>
  <ul>
    <li>Tags:</li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/machine learning">machine learning</a></li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/python">python</a></li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/technical">technical</a></li>
    
  </ul>
</div>

  <div class="post-descr text-justify">
    <p>
      <div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;">In my last post on machine learning I talked about how to implement simple linear regression in Python. This time I am going to implement logistic regression. This technique is used to classify input data into one of several classes.</div><div style="text-align: justify;"><div style="text-align: justify;"><br /></div><div style="text-align: justify;">First let's take a look at two class regression.</div><div style="text-align: justify;"><br /></div><div style="text-align: justify;">Let's have a set of input vectors $\{x_1, x_2, ... , x_N\}$ and a set of targets $\{t_1, t_2, t_3, ..., t_N\}$ as our training data. A logistic regression classifier defines a model $y(x,w) = h(w^Tx)$. The function $h(a)$ is a logistic sigmoid function or a "squashing" function that takes the output of the linear function $w^Tx$ and sqeezes it into a range of values from 0 to 1. Using the logistic sigmoid function allows us to interpret the output of the classifier as the probability that the input belongs to class 1 under certain assumptions.</div><br />So just like in linear regression we need to define cost function in terms of the parameters so that we have a measure of the performance of the model and a way to train the model. In the case of logistic regression there is a cost function - that is very effective and commonly used - called the <i>cross entropy</i>&nbsp;cost function. This cost function is again selected based on a probabilistic interpretation of the classifier.<br /><br />$$J &nbsp;= -\sum_{n=1}^{N}t_n ln(y(x_n) + (1-t_n)ln(1-y(x_n))$$<br /><br />The gradient of this cost function is surprisingly the same as the gradient of the square error cost function.<br /><br />$$\frac{\partial J}{\partial W} = \sum_{n=1}^{N}(y(x_n) - t_n)x_n$$<br /><br />The weights of the model can be adjusted using the gradient descent algorithm just like in linear regression. The classifier will generate a straight that will separate the two classes.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-iu_23IuO6GU/VvD8hRNpGdI/AAAAAAAAJNE/4Evp4p6aRZ8aD595Ao_Kq6-bfFgiIssCQ/s1600/index.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="286" src="https://2.bp.blogspot.com/-iu_23IuO6GU/VvD8hRNpGdI/AAAAAAAAJNE/4Evp4p6aRZ8aD595Ao_Kq6-bfFgiIssCQ/s400/index.png" width="400" /></a></div><br /><br /><br />Multiclass logistic regression can be done using many logistic regression units if the goal is to perform multiple binary classifications. However, if you have a vector that needs to be assigned to one of K classes, the procedure is slightly different. Multiclass regression is performed using the model $y(x) = softmax(W^Tx + \vec{b})$ where x is the input vector, W is a matrix with K columns where each column is a parameter vector, $\vec{b}$ is a vector of biases and the softmax function is defined as follows.<br /><br />$$softmax(a_j) = \frac{e^{a_j}}{\sum_{k=1}^{K}e^{a_k}}$$<br /><br />Each of the targets to train the classifier will be an array of size K. If an input belongs to class k, the kth position of the array will be a one. The rest of the elements in the array will be zero. This is called 'one-hot encoding'. It is easy to see from the definition of the softmax function that the output of the classifier will be an array of values&nbsp; that are between zero and one and that the sum of all the elements in the output array will be 1. This means that we can interpret the output array as a probability distribution that tells you the probabilities that the input vector belongs to each of the K classes.<br /><br />Like in two class classification, the input data (with N vectors and dimension M) set can be arranged in a NxM array $X$ where each row is an input vector. The corresponding targets can be arranged in a matrix T that has N rows and K columns. If the input vector $x_n$ belongs to class K the element $T_{nk}$ will be one. The rest of the elements of the matrix will be zero.<br /><br />The cost function is the same cross entropy function extended to work with the matrix T.<br />$$J = -\sum_{n=1}^{N}\sum_{k=1}^{K}T_{nk}ln(y_k(x_n))$$ <br />&nbsp;However, since we are using a softmax function instead of the logistic sigmoid function, the gradient of the cost function will be different. The derivation to obtain expression for the gradient gets very hairy but the expression for the gradient is surprisingly simple.<br /><br />$$\frac{\partial J}{\partial W_{uv}} = \sum_{n=1}^{N}X^T_{vn}(t_{nu} - y_{nu})$$<br /><br />Once we have this gradient, gradient descent can be performed on the parameters in the same way. I gathered all the vectorized implementations of the equations I've mentioned into a classifier class in Python for ease of usage. <br /><br /><script src="https://gist.github.com/RationalAsh/4485e789eb338a535bce.js"></script><br /><br />To test the classifier I created a scatter of normally distributed points centred around different means on a 2D plane and applied the classifier. With a little bit of help from stackoverflow I was able to figure out how to color the regions of the plot according to the trained classifier.<br /><br /><div class="separator" style="clear: both; text-align: center;"></div><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://1.bp.blogspot.com/-ywuktlIYCVg/VvIBH30fZnI/AAAAAAAAJN4/-Kj3n6-G_jwr3tgR8nau7HixQm4OJW6WA/s1600/unclassified.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="480" src="https://1.bp.blogspot.com/-ywuktlIYCVg/VvIBH30fZnI/AAAAAAAAJN4/-Kj3n6-G_jwr3tgR8nau7HixQm4OJW6WA/s640/unclassified.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">This is a scatter plot of the unclassified data. The points were generated using multivariate normal distributions using different means.</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://3.bp.blogspot.com/-HyCdzW-ifQk/VvIBH2t7evI/AAAAAAAAJN0/u7BDFR5y84URbbbkX66POy35QsNW4ob2g/s1600/error.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="480" src="https://3.bp.blogspot.com/-HyCdzW-ifQk/VvIBH2t7evI/AAAAAAAAJN0/u7BDFR5y84URbbbkX66POy35QsNW4ob2g/s640/error.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">This is a plot of the error or the cost over time as the gradient descent algorithm runs.</td></tr></tbody></table><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-sf715jvJN7A/VvIBH1xw3pI/AAAAAAAAJNw/YQgCQ8mkkIgKeHGUqOAXc5WtlqqLOM9FA/s1600/classified.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="480" src="https://4.bp.blogspot.com/-sf715jvJN7A/VvIBH1xw3pI/AAAAAAAAJNw/YQgCQ8mkkIgKeHGUqOAXc5WtlqqLOM9FA/s640/classified.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">A plot of the decision regions learned by the classifier. If a region is shaded a particular color, that means that the classifier identifies all the points in that region as belonging to the same class.</td></tr></tbody></table><br /><div class="separator" style="clear: both; text-align: center;"></div><br /><div class="separator" style="clear: both; text-align: center;"></div></div><div style="text-align: justify;"><br /></div></div>

    </p>
  </div>
  <hr>
  
  <h2 class="post-title">
    <a href="http://www.ashwinnarayan.com/blog/2016/02/my-first-build-of-bb-8">
      My First Build of BB-8
    </a>
  </h3>

  <div class="post-meta">
  <div class="post-time">
    <!--<i class="fa fa-calendar"></i>-->
    Posted on:
    <time>27 Feb 2016</time>
  </div>
  <ul>
    <li>Tags:</li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/cool stuff">cool stuff</a></li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/robotics">robotics</a></li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/star wars">star wars</a></li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/technical">technical</a></li>
    
  </ul>
</div>

  <div class="post-descr text-justify">
    <p>
      <div dir="ltr" style="text-align: left;" trbidi="on"><div style="text-align: justify;">Being a robotics person, the part of Star Wars: The Force Awakens that gave me the most delight was BB-8! The cute little droid who rolls along on a sphere. The moment I saw it on screen I knew that I had to build it! This blogpost documents my entire build process.<br /><br />I decided that the first thing I should do is come up with a good control mechanism. The first thing I thought of was a pendulum hanging from a diametric bar inside the sphere. The pendulum would be free hanging and an actuator would apply torque on it and make the sphere roll. This seemed a simple enough system to work with. So I started the process of simulating the robot and coming up with a good control system.<br /><br /><h3>The Mathy Stuff</h3>The easiest way to model a sort of complex system like this is to use Lagrangian mechanics. Write down the difference between the kinetic and potential energies of the system, apply the Euler-Lagrange equations to get the equations of motion and plug the equations into a differential equation with initial conditions. This general procedure can be used to simulate a wide range of mechanical systems. It's an essential part of any roboticist's toolkit.<br /><br />In the case of the BB-8 sphere pendulum system the equations of motion come out as:<br /><br />$\frac{5}{3} m_b \ddot{x}(t)+m_p \left(l \ddot{\theta}(t) \cos (\theta (t))-l \dot{\theta}(t)^2 \sin (\theta (t))+\ddot{x}(t)\right)=\frac{u(t)}{r}$<br />$l m_p \left(g \sin (\theta (t))+l \ddot{\theta}(t)+\cos (\theta (t)) \ddot{x}(t)\right)=-u(t)$<br /><br />Here $m_b$ is the mass of the ball, $m_p$ is the mass of the pendulum, $l$ the length of the pendulum rod and $r$ the radius of the sphere. The state of the robot is represented by the state vector $\left[ \begin{array}{c} x \\ \theta \\ \dot{x} \\ \dot{\theta} \end{array} \right]$ where $x$ is the distance the sphere has rolled and $\theta$ is the angle the pendulum makes with the vertical.<br /><br />When the motor applies a torque on the pendulum, it also applies an equal and opposite torque on the shaft on the spherical body. This is the control torque we're going to use to make BB-8 roll back and forth. For the mass of the pendulum I am using another motor with a weighted disk. This motor can react against the weighted disk to make the robot turn left and right. These two mechanisms are enough to make BB-8 go anywhere! Since this robot is an open chain manipulator, the equations of motion can be written in the manipulator equation form $H(q)\ddot{q}&nbsp;+ C(q,\dot{q})\dot{q}&nbsp;+ G(q) = Bu$.<br /><br />$\left[\begin{array}{cc}\frac{5}{3}m_b + m_p &amp; m_pl\cos\theta \\ m_pl\cos\theta &amp; m_pl^2\end{array}\right] \left[\begin{array}{c}\ddot{x} \\ \ddot{\theta}\end{array}\right] + \left[\begin{array}{cc}0 &amp; -m_pl\dot{\theta}\sin\theta \\ 0 &amp; 0&nbsp;\end{array}\right] \left[\begin{array}{c}\dot{x} \\ \dot{\theta}\end{array}\right] +&nbsp;\left[\begin{array}{c}0 \\ m_pgl\sin\theta\end{array}\right] =&nbsp;\left[\begin{array}{c}&nbsp;\frac{1}{r} \\ -1&nbsp;\end{array}\right] u $<br /><br />This is what the system looks like without any motors.<br /><div class="separator" style="clear: both; text-align: center;"><a href="http://i.imgur.com/fzPA2yp.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" src="http://i.imgur.com/fzPA2yp.gif" height="160" width="640" /></a></div><br /><br />We can easily write the manipulator equation to the standard form ( $\dot{x} = f(x,u)$ ), linearize it around any equilibrium point to get a linear state space model and implement a linear controller. I'm so glad that I had Mathematica to help me with the modeling. It made things very simple and I could get a simple LQR for controlling the sphere working without too much hassle. Here's what the motion of the sphere looks like with the controller.&nbsp;</div><div style="text-align: justify;"><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="http://3.bp.blogspot.com/-TIaokW7Nk20/VqCChsZS-DI/AAAAAAAAHsI/YrXyDhkFNbo/s1600/dpend_sim2.gif" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="160" src="https://3.bp.blogspot.com/-TIaokW7Nk20/VqCChsZS-DI/AAAAAAAAHsI/YrXyDhkFNbo/s640/dpend_sim2.gif" width="640" /></a></div><div style="text-align: justify;"><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://4.bp.blogspot.com/-_G1jSQmsRME/VtCv7hEzCJI/AAAAAAAAIAc/Kv5Sd-uDgOg/s1600/bb8_lqr_graph.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="186" src="https://4.bp.blogspot.com/-_G1jSQmsRME/VtCv7hEzCJI/AAAAAAAAIAc/Kv5Sd-uDgOg/s320/bb8_lqr_graph.jpeg" width="320" /></a></div><br /><h3>The Body</h3>Now it's time to build! First I was stuck on what to make the sphere out of. I didn't want the robot to be too small and at first, I couldn't think of any place to find a sphere. So i started designing a spherical shell in Blender. I had to do it in parts because of size constraints on the 3D printer. This was very time consuming. And then it struck me! I could use on of these! :D<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://1.bp.blogspot.com/-V-g3BxRy0fk/VrNCn2IG4lI/AAAAAAAAH4Y/gdUvdzhNaqU/s1600/globe.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="200" src="https://1.bp.blogspot.com/-V-g3BxRy0fk/VrNCn2IG4lI/AAAAAAAAH4Y/gdUvdzhNaqU/s200/globe.jpg" width="200" /></a></div><insert globe="" of="" photo=""></insert><br /><br />I bought a 20 cm diameter globe off amazon. The sphere is made out of ABS plastic which is really nice. I used a hacksaw to cut the sphere in half. The next challenge is to mount the motors. I tried reusing empty potato chip cans but most of them didn't have the dimensions that I wanted. So in the end I decided to 3D print a motor housing and some parts to couple the sphere to the motors. I used Blender (Open Source! Yay! :D) to design the parts.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="http://4.bp.blogspot.com/-oGep7_zoMjg/VrNDtC4ncOI/AAAAAAAAH4g/-cYZI97JOaQ/s1600/Model2.png" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="360" src="https://4.bp.blogspot.com/-oGep7_zoMjg/VrNDtC4ncOI/AAAAAAAAH4g/-cYZI97JOaQ/s640/Model2.png" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">Initial Render of what the internals were going to look like.</td></tr></tbody></table>However, it turned out that 3D printing parts is a bit time consuming. Also, the motor couplings were difficult to print without using a lot of support material. After a few iterations of redesigning and checking, the final motor coupling was printed. I made a decent looking motor housing out of some wood and metal L-shaped motor mounts.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-crMs9A5vpFQ/VslKOuFgUAI/AAAAAAAAH7I/FcSVql4V0y0/s1600/P_20160220_235153.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="360" src="https://4.bp.blogspot.com/-crMs9A5vpFQ/VslKOuFgUAI/AAAAAAAAH7I/FcSVql4V0y0/s640/P_20160220_235153.jpg" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">The motor assembly</td></tr></tbody></table><h3>The Electronics</h3><div>An Arduino Nano with an Atmega328 is the brain of the robot. A GY521 accelerometer/gyro board helps me measure the angle of the motor assembly with respect to the ground and a rotary encoder coupled to the dead axle helps me measure the speed and position of the ball. A HC05 Bluetooth module communicates with an Android app that I made using MIT App Inventor so that I can control the robot.&nbsp;</div><div><br /></div><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-kXoJlI2km1E/VsyS9GCf1vI/AAAAAAAAH9I/PYHUqcDsvQQ/s1600/P_20160221_161359.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="640" src="https://2.bp.blogspot.com/-kXoJlI2km1E/VsyS9GCf1vI/AAAAAAAAH9I/PYHUqcDsvQQ/s640/P_20160221_161359.jpg" width="360" /></a></div><div><br /></div><div>Putting it all together lead to this huge mess of wires.<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="https://2.bp.blogspot.com/-poJHGBdxk3I/VtCsJbK0D8I/AAAAAAAAH_8/5p1VB20ECa4/s1600/P_20160226_102536.jpg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="360" src="https://2.bp.blogspot.com/-poJHGBdxk3I/VtCsJbK0D8I/AAAAAAAAH_8/5p1VB20ECa4/s640/P_20160226_102536.jpg" width="640" /></a></div><br />After multiple attempts at rewiring, I got to this slightly less messy (but still quite messy) state.<br /><br /><table align="center" cellpadding="0" cellspacing="0" class="tr-caption-container" style="margin-left: auto; margin-right: auto; text-align: center;"><tbody><tr><td style="text-align: center;"><a href="https://4.bp.blogspot.com/-UOXXHtVQOQo/VtCsjaXYhXI/AAAAAAAAIAE/ZpIzdLIyaRU/s1600/P_20160227_011727.jpg" imageanchor="1" style="margin-left: auto; margin-right: auto;"><img border="0" height="360" src="https://4.bp.blogspot.com/-UOXXHtVQOQo/VtCsjaXYhXI/AAAAAAAAIAE/ZpIzdLIyaRU/s640/P_20160227_011727.jpg" width="640" /></a></td></tr><tr><td class="tr-caption" style="text-align: center;">The battery is also included in this one.</td></tr></tbody></table>Despite the messiness, it actually works! :D I made it roll around for a bit.<br /><br />Since this was my first build, I decided that it should more of a proof of concept than a robust build. So I built it very fast. Now &nbsp;that I know that it works, I can spend some time designing a nice PCB to make the wiring neater and more compact. I also need to fine tune the control loop so that the whole thing moves smoothly. No point in tuning it on this since I'll be rebuilding a part of it anyway.<br /><br />Watch out for the next post about a more robust build!<br /><br /></div></div></div>

    </p>
  </div>
  <hr>
  
  <h2 class="post-title">
    <a href="http://www.ashwinnarayan.com/blog/2015/11/prime-spirals-in-python">
      Prime Spirals in Python
    </a>
  </h3>

  <div class="post-meta">
  <div class="post-time">
    <!--<i class="fa fa-calendar"></i>-->
    Posted on:
    <time>20 Nov 2015</time>
  </div>
  <ul>
    <li>Tags:</li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/python">python</a></li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/fun">fun</a></li>
    
    <li><a href="http://www.ashwinnarayan.com/blog/tag/math">math</a></li>
    
  </ul>
</div>

  <div class="post-descr text-justify">
    <p>
      <div dir="ltr" style="text-align: left;" trbidi="on"><div class="separator" style="clear: both; text-align: center;"><iframe allowfullscreen="" class="YOUTUBE-iframe-video" data-thumbnail-src="https://i.ytimg.com/vi/iFuR97YcSLM/0.jpg" frameborder="0" height="266" src="https://www.youtube.com/embed/iFuR97YcSLM?feature=player_embedded" width="320"></iframe></div><br />I watched this really fascinating video on prime spirals recently and decided to see if I could write my own code to generate them. It's not terribly efficient but it works! Code is <a href="https://gist.github.com/RationalAsh/88276a1043f63af2db14" target="_blank">on github</a>! :D<br /><br /><div class="separator" style="clear: both; text-align: center;"><a href="http://4.bp.blogspot.com/-YjEXAevkes8/Vk9MzS2I4mI/AAAAAAAAHJA/MzEPhZIKZnM/s1600/prime_spiral.png" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="328" src="http://4.bp.blogspot.com/-YjEXAevkes8/Vk9MzS2I4mI/AAAAAAAAHJA/MzEPhZIKZnM/s640/prime_spiral.png" width="640" /></a></div><br /></div>

    </p>
  </div>
  <hr>
  

  <!-- Pagination links -->
  <div class="pagination">
    
    <span class="previous btn">Previous</span>
    
    <span class="page_number ">Page: 1 of 8</span>
    
    <a href="http://www.ashwinnarayan.com/blog/page2" class="next btn">Next</a>
    
  </div>


<div class="post-footer">
  <div class="column-full">
    <h3><a href="http://www.ashwinnarayan.com/blog/archive.html">Blog archive</a></h3>
  </div>
</div>

          </div>
        </div>
        <div class="col-md-4 hidden-xs">
          <div class="sidebar ">
  <h2>Recent Posts</h2>
  <ul>
    
    <li><a href="/blog/2016/06/new-website-and-blog">New Website and Blog</a></li>
    
    <li><a href="/blog/2016/03/unsupervised-learning-self-organizing">Unsupervised Learning: Self Organizing Maps</a></li>
    
    <li><a href="/blog/2016/03/machine-learning-part-2-implementing">Machine Learning Part 2: Implementing Multi Class Logistic Regression</a></li>
    
    <li><a href="/blog/2016/02/my-first-build-of-bb-8">My First Build of BB-8</a></li>
    
    <li><a href="/blog/2015/11/prime-spirals-in-python">Prime Spirals in Python</a></li>
    
  </ul>
</div>

<div class="sidebar">
  <h2>Tags</h2>
  <ul>
    
      <li><a href="/blog/tag/opencv">opencv</a></li>
    
      <li><a href="/blog/tag/programming">programming</a></li>
    
      <li><a href="/blog/tag/technical">technical</a></li>
    
      <li><a href="/blog/tag/free will">free will</a></li>
    
      <li><a href="/blog/tag/thoughts">thoughts</a></li>
    
      <li><a href="/blog/tag/philosophy">philosophy</a></li>
    
      <li><a href="/blog/tag/atheism">atheism</a></li>
    
      <li><a href="/blog/tag/linux">linux</a></li>
    
      <li><a href="/blog/tag/blogging">blogging</a></li>
    
      <li><a href="/blog/tag/web">web</a></li>
    
      <li><a href="/blog/tag/window managers">window managers</a></li>
    
      <li><a href="/blog/tag/productivity">productivity</a></li>
    
      <li><a href="/blog/tag/robotics">robotics</a></li>
    
      <li><a href="/blog/tag/inverse kinematics">inverse kinematics</a></li>
    
      <li><a href="/blog/tag/robotic arm">robotic arm</a></li>
    
      <li><a href="/blog/tag/boiling water">boiling water</a></li>
    
      <li><a href="/blog/tag/coffee">coffee</a></li>
    
      <li><a href="/blog/tag/fire">fire</a></li>
    
      <li><a href="/blog/tag/random stuff">random stuff</a></li>
    
      <li><a href="/blog/tag/electric kettle">electric kettle</a></li>
    
      <li><a href="/blog/tag/electronics">electronics</a></li>
    
      <li><a href="/blog/tag/fpga">fpga</a></li>
    
      <li><a href="/blog/tag/youtube">youtube</a></li>
    
      <li><a href="/blog/tag/fun">fun</a></li>
    
      <li><a href="/blog/tag/cool stuff">cool stuff</a></li>
    
      <li><a href="/blog/tag/arduino">arduino</a></li>
    
      <li><a href="/blog/tag/vga">vga</a></li>
    
      <li><a href="/blog/tag/python">python</a></li>
    
      <li><a href="/blog/tag/Singapore">Singapore</a></li>
    
      <li><a href="/blog/tag/movie review">movie review</a></li>
    
      <li><a href="/blog/tag/terminator genisys">terminator genisys</a></li>
    
      <li><a href="/blog/tag/terminator">terminator</a></li>
    
      <li><a href="/blog/tag/maker faire">maker faire</a></li>
    
      <li><a href="/blog/tag/rant">rant</a></li>
    
      <li><a href="/blog/tag/ashley madison">ashley madison</a></li>
    
      <li><a href="/blog/tag/hack">hack</a></li>
    
      <li><a href="/blog/tag/hacking">hacking</a></li>
    
      <li><a href="/blog/tag/the martian">the martian</a></li>
    
      <li><a href="/blog/tag/books">books</a></li>
    
      <li><a href="/blog/tag/book review">book review</a></li>
    
      <li><a href="/blog/tag/science fiction">science fiction</a></li>
    
      <li><a href="/blog/tag/math">math</a></li>
    
      <li><a href="/blog/tag/space">space</a></li>
    
      <li><a href="/blog/tag/Mathematica">Mathematica</a></li>
    
      <li><a href="/blog/tag/machine learning">machine learning</a></li>
    
      <li><a href="/blog/tag/star wars">star wars</a></li>
    
  </ul>
</div>

        </div>
      </div>
    </div>
  </div>
      <footer class="footer-distributed">
      <div class="container">
        <div class="footer">
          <p>Ashwin Narayan &copy; 2016</p>
          <h6>Follow me</h6>

<ul class="social-media">

  
    <li>
      <a title="RationalAsh on Github" href="https://github.com/RationalAsh" target="_blank"><i class="fa fa-github fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title=" on StackOverflow" href="http://stackoverflow.com/users/" target="_blank"><i class="fa fa-stack-overflow fa-2x"></i></a>
    </li>
  

  

  
    <li>
      <a title=" on Instagram" href="https://instagram.com/" target="_blank"><i class="fa fa-instagram fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title=" on Last.fm" href="http://lastfm.com/user/" target="_blank"><i class="fa fa-lastfm fa-2x"></i></a>
    </li>
  

  
    <li>
      <a title="feed.xml RSS" href="/blog/feed.xml" target="_blank"><i class="fa fa-rss fa-2x"></i></a>
    </li>
  

</ul>

	  <p><a href="https://github.com/streetturtle/jekyll-clean-dark">Jekyll Clean Dark Theme</a> by Pavel Makhov</p>
        </div>
      </div>
    </footer>
  </body>
</html>

</div>
